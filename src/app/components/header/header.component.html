<p-menubar [model]="menuItems()" autoDisplay>
  <ng-template pTemplate="item" let-item let-root="root">
    <a class="flex p-menuitem-link" [routerLink]="item.routerLink">
      @if (item.img) {
        <img [src]="imgBaseUrl + item.img" alt="" width="32px" height="32px" />
      } @else {
        <span [class]="item.icon"></span>
      }
      <span>{{ item.label }}</span>
    </a>
  </ng-template>
  <ng-template pTemplate="end">
    <div class="flex">
      @if (structures().length > 1) {
        <p-select
          [ngModel]="selectedStructureId()"
          [options]="structures()"
          optionLabel="name"
          optionValue="id"
          [style]="{ width: '200px' }"
          (onChange)="setSelectStructureById($event.value)">
          <ng-template #selectedItem let-item>
            <div class="flex">
              @if (item.image) {
                <img
                  [src]="imgBaseUrl + item.image"
                  alt=""
                  width="24px"
                  height="24px" />
              } @else if (item.color) {
                <p-badge
                  size="small"
                  value=" "
                  [style]="{ 'background-color': item.color }" />
              } @else {
                <span [class]="item.icon"></span>
              }
              <div>{{ item.name }}</div>
            </div>
          </ng-template>

          <ng-template let-item #item>
            <div class="flex">
              @if (item.image) {
                <img
                  [src]="imgBaseUrl + item.image"
                  alt=""
                  width="24px"
                  height="24px" />
              } @else if (item.color) {
                <p-badge
                  size="small"
                  value=" "
                  [style]="{ 'background-color': item.color }" />
              } @else {
                <span [class]="item.icon"></span>
              }

              <div>{{ item.name }}</div>
            </div>
          </ng-template>
        </p-select>
      } @else {
        <span class="mr-4">
          {{ selectedStructure()?.name ?? 'Groupe Actif' }}
        </span>
      }
      <p-tieredMenu #userMenu [popup]="true" [model]="authItems()">
        <ng-template #item let-item let-hasSubmenu="hasSubmenu">
          <a pRipple class="flex items-center p-tieredmenu-item-link">
            @if (item.img) {
              <img
                [src]="imgBaseUrl + item.img"
                alt=""
                width="32px"
                height="32px" />
            } @else if (item.color) {
              <p-badge
                size="small"
                value=" "
                [style]="{ 'background-color': item.color }" />
            } @else {
              <span [class]="item.icon"></span>
            }
            <span class="ml-2">{{ item.label }}</span>
            @if (hasSubmenu) {
              <i class="pi pi-angle-right ml-auto"></i>
            }
          </a>
        </ng-template>
      </p-tieredMenu>
      <p-avatar
        (click)="userMenu.toggle($event)"
        [label]="lettres()"
        shape="circle"
        size="large" />
    </div>
  </ng-template>
</p-menubar>
