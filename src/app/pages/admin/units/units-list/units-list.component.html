<div class="header">
  <div class="flex">
    <h1>Unités du groupe</h1>
  </div>

  <p-button
    icon="pi pi-plus"
    label="Ajouter"
    (onClick)="openCreateUnitDialog()" />
</div>

<matos-table [status]="status()">
  <p-table [value]="units.value() ?? []" stripedRows>
    <ng-template #header>
      <tr>
        <th>Nom</th>
        <th>Couleur</th>
        <th>Contact matériel</th>
        <th>
          Chefs
          <p-button
            (click)="toggleShowChiefsList()"
            [icon]="'pi' + (showChiefsList() ? ' pi-eye-slash' : 'pi-eye')" />
        </th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template #body let-unit>
      <tr>
        <td>{{ unit.name }}</td>
        <td style="vertical-align: middle">
          <div
            [style]="
              `width: 40px; height: 28px; background-color: ${unit.color}; border-radius: 4px;`
            "></div>
        </td>
        <td>{{ unit.responsible?.name }}</td>
        <td>
          @if (showChiefsList()) {
            <ul>
              @for (chef of unit.chiefs; track $index) {
                <li>{{ chef.name }}</li>
              }
            </ul>
          } @else {
            {{ unit.chiefs.length }}
          }
        </td>
        <td class="actions">
          <p-button
            icon="pi pi-pencil"
            (onClick)="openUpdateUnitDialog(unit)"
            size="small" />
          <!-- <p-button size="small" icon="pi pi-trash" severity="danger" /> -->
        </td>
      </tr>
    </ng-template>
  </p-table>
</matos-table>
